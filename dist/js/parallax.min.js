if("undefined"==typeof Zepto)throw new Error("Parallax.js's JavaScript requires Zepto");!function(a){"use strict";function s(){m=b.length,p=a(window).width(),h=a(window).height();for(var s=0;m>s;s++)a(b[s]).attr("data-id",s);k.loading||a(b[v]).addClass("current"),u.addClass(k.direction).addClass(k.swipeAnim),b.css({width:p+"px",height:h+"px"}),"horizontal"==k.direction?u.css("width",p*b.length):u.css("height",h*b.length),("cover"==k.swipeAnim||"victoria"==k.swipeAnim)&&(u.css({width:p,height:h}),b[0].style.display="block"),k.indicator||k.music||k.loading?(a(".wrapper").append('<div class="helper"></div>'),k.loading&&a(".helper").append('<div class="h-loading"><ul class="spinner"><li></li><li></li><li></li><li></li></ul></div>')):g=!1}function e(a){return 1==g?(event.preventDefault(),!1):(x=!0,l="horizontal"==k.direction?a.pageX:a.pageY,"default"==k.swipeAnim&&u.addClass("drag"),f=u.css("-webkit-transform").replace("matrix(","").replace(")","").split(","),f="horizontal"==k.direction?parseInt(f[4]):parseInt(f[5]),w=1,void 0)}function t(a){return 1==g||0==x?(event.preventDefault(),!1):(event.preventDefault(),c="horizontal"==k.direction?a.pageX:a.pageY,o(),"default"==k.swipeAnim?k.drag&&i():"cover"==k.swipeAnim?k.drag&&i():"victoria"==k.swipeAnim&&k.drag&&i(),w=2,void 0)}function r(s){return 1==g||2!=w?(event.preventDefault(),!1):(x=!1,c="horizontal"==k.direction?s.pageX:s.pageY,"default"==k.swipeAnim?(u.removeClass("drag"),Math.abs(c-l)<=50?n(v):d()||(c>=l?n(v-1):n(v+1))):"cover"==k.swipeAnim?k.drag?d()||(Math.abs(c-l)<=50?c>=l?"horizontal"==k.direction?a(b[v-1]).css({"-webkit-transform":"translate3d(-100%, 0, 0)"}):a(b[v-1]).css({"-webkit-transform":"translate3d(0, -100%, 0)"}):"horizontal"==k.direction?a(b[v+1]).css({"-webkit-transform":"translate3d(100%, 0, 0)"}):a(b[v+1]).css({"-webkit-transform":"translate3d(0, 100%, 0)"}):c>=l?n(v-1,"backward"):n(v+1,"forward")):d()||Math.abs(c-l)>=50&&(c>=l?n(v-1,"backward"):n(v+1,"forward")):"victoria"==k.swipeAnim&&(k.drag?d()||(Math.abs(c-l)<=50?c>=l?(a(b[v]).css({"-webkit-transform":"translate3d(0, 0, 0) scale(1)"}),"horizontal"==k.direction?a(b[v-1]).css({"-webkit-transform":"translate3d(-100%, 0, 0)"}):a(b[v-1]).css({"-webkit-transform":"translate3d(0, -100%, 0)"})):(a(b[v]).css({"-webkit-transform":"translate3d(0, 0, 0) scale(1)"}),"horizontal"==k.direction?a(b[v+1]).css({"-webkit-transform":"translate3d(100%, 0, 0)"}):a(b[v+1]).css({"-webkit-transform":"translate3d(0, 100%, 0)"})):c>=l?n(v-1,"backward"):n(v+1,"forward")):d()||Math.abs(c-l)>=50&&(c>=l?n(v-1,"backward"):n(v+1,"forward"))),a(b.removeClass("current").get(v)).addClass("current"),k.indicator&&a(a(".h-indicator ul li").removeClass("current").get(v)).addClass("current"),w=3,void 0)}function i(){if("default"==k.swipeAnim){var s=f+c-l;d()||("horizontal"==k.direction?u.css("-webkit-transform","matrix(1, 0, 0, 1, "+s+", 0)"):u.css("-webkit-transform","matrix(1, 0, 0, 1, 0, "+s+")"))}else if("cover"==k.swipeAnim){var s=c-l;d()||("horizontal"==k.direction?c>=l?(a(b).css({"z-index":0}),a(b[v-1]).css({"z-index":2}).show(),b[v-1].style.webkitTransform="translate3d("+(s-p)+"px, 0 ,0)"):(a(b).css({"z-index":0}),a(b[v+1]).css({"z-index":2}).show(),b[v+1].style.webkitTransform="translate3d("+(p+s)+"px, 0, 0)"):c>=l?(a(b).css({"z-index":0}),a(b[v-1]).css({"z-index":2}).show(),b[v-1].style.webkitTransform="translate3d(0,"+(s-h)+"px ,0)"):(a(b).css({"z-index":0}),a(b[v+1]).css({"z-index":2}).show(),b[v+1].style.webkitTransform="translate3d(0,"+(h+s)+"px ,0)"))}else if("victoria"==k.swipeAnim){var s=c-l;d()||("horizontal"==k.direction?c>=l?(a(b).css({"z-index":0}),a(b[v-1]).css({"z-index":2}).show(),b[v].style.webkitTransform="translate3d("+s/10+"px,0,0) scale("+(1-Math.abs(s/(p/20))/100)+")",b[v-1].style.webkitTransform="translate3d("+(s-p)+"px,0,0)"):(a(b).css({"z-index":0}),a(b[v+1]).css({"z-index":2}).show(),b[v].style.webkitTransform="translate3d("+s/10+"px,0,0) scale("+(1-Math.abs(s/(p/20))/100)+")",b[v+1].style.webkitTransform="translate3d("+(p+s)+"px,0,0)"):c>=l?(a(b).css({"z-index":0}),a(b[v-1]).css({"z-index":2}).show(),b[v].style.webkitTransform="translate3d(0,"+s/10+"px,0) scale("+(1-Math.abs(s/(h/20))/100)+")",b[v-1].style.webkitTransform="translate3d(0,"+(s-h)+"px ,0)"):(a(b).css({"z-index":0}),a(b[v+1]).css({"z-index":2}).show(),b[v].style.webkitTransform="translate3d(0,"+s/10+"px,0) scale("+(1-Math.abs(s/(h/20))/100)+")",b[v+1].style.webkitTransform="translate3d(0,"+(h+s)+"px ,0)"))}}function n(s,e){if(v=s,"default"==k.swipeAnim){var t=0;"horizontal"==k.direction?(t=s*-p,u.css({"-webkit-transform":"matrix(1, 0, 0, 1, "+t+", 0)"})):(t=s*-h,u.css({"-webkit-transform":"matrix(1, 0, 0, 1, 0, "+t+")"}))}else"cover"==k.swipeAnim?k.drag?"forward"==e?(a(b[v-1]).addClass("back"),b[v].style.webkitTransform="translate3d(0, 0, 0)"):(a(b[v+1]).addClass("back"),b[v].style.webkitTransform="translate3d(0, 0, 0)"):"forward"==e?(u.addClass("animate"),a(b[v-1]).addClass("back"),a(b[v]).addClass("front").show(),console.log(1)):(u.addClass("animate"),a(b[v+1]).addClass("back"),a(b[v]).addClass("front").show(),console.log(2)):"victoria"==k.swipeAnim&&(k.drag?"forward"==e?(a(b[v-1]).addClass("back"),b[v-1].style.webkitTransform="horizontal"==k.direction?"translate3d(-60px, 0, 0) scale(0.8)":"translate3d(0, -60px, 0) scale(0.8)",b[v].style.webkitTransform="translate3d(0, 0, 0)"):(a(b[v+1]).addClass("back"),b[v+1].style.webkitTransform="horizontal"==k.direction?"translate3d(60px, 0, 0) scale(0.8)":"translate3d(0, 60px, 0) scale(0.8)",b[v].style.webkitTransform="translate3d(0, 0, 0)"):"forward"==e?(u.addClass("animate"),a(b[v-1]).addClass("back"),a(b[v]).addClass("front").show()):(u.addClass("animate"),a(b[v+1]).addClass("back"),a(b[v]).addClass("front").show()));g=!0,setTimeout(function(){g=!1},k.speed)}function o(){"horizontal"==k.direction?c>=l?u.removeClass("forward").addClass("backward"):l>c&&u.removeClass("backward").addClass("forward"):c>=l?u.removeClass("forward").addClass("backward"):l>c&&u.removeClass("backward").addClass("forward")}function d(){if("horizontal"==k.direction){if(c>=l&&0==v||l>=c&&v==m-1)return!0}else if(c>=l&&0==v||l>=c&&v==m-1)return!0;return!1}var l,c,w,f,m,p,h,u,b,k,v=0,x=!1,g=!0;a.fn.parallax=function(e){return k=a.extend({},a.fn.parallax.defaults,e),this.each(function(){u=a(this),b=u.find("section"),s(),u.on("webkitAnimationEnd webkitTransitionEnd",function(){setTimeout(function(){a(".back").hide().removeClass("back"),a(".front").show().removeClass("front"),u.removeClass("forward backward animate")},10)})})},a.fn.parallax.defaults={direction:"portrait",swipeAnim:"default",drag:!1,loading:!1,indicator:!1,arrow:!1,music:!1,musicUrl:""},a(document).on("touchstart",function(a){e(a.changedTouches[0])}).on("touchmove",function(a){t(a.changedTouches[0])}).on("touchend",function(a){r(a.changedTouches[0])}).on("click",".h-music",function(){}).on("orientationchange",function(){"default"==k.swipeAnim&&s()}),a(window).on("load",function(){if(k.loading&&(a(".h-loading").remove(),g=!1,a(b[v]).addClass("current")),k.indicator){g=!1,a(".helper").append('<div class="h-indicator"></div>');for(var s="<ul>",e=1;m>=e;e++)s+=1==e?'<li class="current">'+e+"</li>":"<li>"+e+"</li>";s+="</ul>",a(".h-indicator").append(s)}if(k.arrow&&(b.append('<span class="h-arrow"></span>'),a(b[m-1]).find(".h-arrow").remove()),k.music){if(g=!1,""==musicUrl)throw new Error("music url is needed.");a(".helper").append('<div class="h-music"></div>')}})}(Zepto);
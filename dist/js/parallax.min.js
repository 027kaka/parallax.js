if("undefined"==typeof Zepto)throw new Error("Parallax.js's JavaScript requires Zepto");!function(a){"use strict";function s(){m=b.length,h=a(window).width(),p=a(window).height();for(var s=0;m>s;s++)a(b[s]).attr("data-id",s+1);v.loading||a(b[k]).addClass("current"),u.addClass(v.direction).addClass(v.swipeAnim),b.css({width:h+"px",height:p+"px"}),"horizontal"==v.direction?u.css("width",h*b.length):u.css("height",p*b.length),("cover"==v.swipeAnim||"victoria"==v.swipeAnim)&&(u.css({width:h,height:p}),b[0].style.display="block"),v.indicator||v.music||v.loading?(a(".wrapper").append('<div class="helper"></div>'),v.loading&&a(".helper").append('<div class="h-loading"><ul class="spinner"><li></li><li></li><li></li><li></li></ul></div>')):g=!1}function e(a){return 1==g?(event.preventDefault(),!1):(x=!0,l="horizontal"==v.direction?a.pageX:a.pageY,"default"==v.swipeAnim&&u.addClass("drag"),("cover"==v.swipeAnim&&v.drag||"victoria"==v.swipeAnim&&v.drag)&&b.addClass("drag"),f=u.css("-webkit-transform").replace("matrix(","").replace(")","").split(","),f="horizontal"==v.direction?parseInt(f[4]):parseInt(f[5]),w=1,void 0)}function r(a){return 1==g||0==x?(event.preventDefault(),!1):(event.preventDefault(),c="horizontal"==v.direction?a.pageX:a.pageY,o(),"default"==v.swipeAnim?v.drag&&i():"cover"==v.swipeAnim?v.drag&&i():"victoria"==v.swipeAnim&&v.drag&&i(),w=2,void 0)}function t(s){return 1==g||2!=w?(event.preventDefault(),!1):(x=!1,c="horizontal"==v.direction?s.pageX:s.pageY,"default"==v.swipeAnim?(u.removeClass("drag"),Math.abs(c-l)<=50?n(k):d()||(c>=l?n(k-1):n(k+1))):"cover"==v.swipeAnim?v.drag?(b.removeClass("drag"),d()||(Math.abs(c-l)<=50?c>=l?"horizontal"==v.direction?a(b[k-1]).css({"-webkit-transform":"translate3d(-100%, 0, 0)"}):a(b[k-1]).css({"-webkit-transform":"translate3d(0, -100%, 0)"}):"horizontal"==v.direction?a(b[k+1]).css({"-webkit-transform":"translate3d(100%, 0, 0)"}):a(b[k+1]).css({"-webkit-transform":"translate3d(0, 100%, 0)"}):c>=l?n(k-1,"backward"):n(k+1,"forward"))):d()||Math.abs(c-l)>=50&&(c>=l?n(k-1,"backward"):n(k+1,"forward")):"victoria"==v.swipeAnim&&(v.drag?(b.removeClass("drag"),d()||(Math.abs(c-l)<=50?c>=l?(a(b[k]).css({"-webkit-transform":"translate3d(0, 0, 0) scale(1)"}),"horizontal"==v.direction?a(b[k-1]).css({"-webkit-transform":"translate3d(-100%, 0, 0)"}):a(b[k-1]).css({"-webkit-transform":"translate3d(0, -100%, 0)"})):(a(b[k]).css({"-webkit-transform":"translate3d(0, 0, 0) scale(1)"}),"horizontal"==v.direction?a(b[k+1]).css({"-webkit-transform":"translate3d(100%, 0, 0)"}):a(b[k+1]).css({"-webkit-transform":"translate3d(0, 100%, 0)"})):c>=l?n(k-1,"backward"):n(k+1,"forward"))):d()||Math.abs(c-l)>=50&&(c>=l?n(k-1,"backward"):n(k+1,"forward"))),a(b.removeClass("current").get(k)).addClass("current"),v.indicator&&a(a(".h-indicator ul li").removeClass("current").get(k)).addClass("current"),w=3,void 0)}function i(){if("default"==v.swipeAnim){var s=f+c-l;d()||("horizontal"==v.direction?u.css("-webkit-transform","matrix(1, 0, 0, 1, "+s+", 0)"):u.css("-webkit-transform","matrix(1, 0, 0, 1, 0, "+s+")"))}else if("cover"==v.swipeAnim){var s=c-l;d()||("horizontal"==v.direction?c>=l?(a(b).css({"z-index":0}),a(b[k-1]).css({"z-index":2}).show(),b[k-1].style.webkitTransform="translate3d("+(s-h)+"px, 0 ,0)"):(a(b).css({"z-index":0}),a(b[k+1]).css({"z-index":2}).show(),b[k+1].style.webkitTransform="translate3d("+(h+s)+"px, 0, 0)"):c>=l?(a(b).css({"z-index":0}),a(b[k-1]).css({"z-index":2}).show(),b[k-1].style.webkitTransform="translate3d(0,"+(s-p)+"px ,0)"):(a(b).css({"z-index":0}),a(b[k+1]).css({"z-index":2}).show(),b[k+1].style.webkitTransform="translate3d(0,"+(p+s)+"px ,0)"))}else if("victoria"==v.swipeAnim){var s=c-l;d()||("horizontal"==v.direction?c>=l?(a(b).css({"z-index":0}),a(b[k-1]).css({"z-index":2}).show(),b[k].style.webkitTransform="translate3d("+s/10+"px,0,0) scale("+(1-Math.abs(s/(h/20))/100)+")",b[k-1].style.webkitTransform="translate3d("+(s-h)+"px,0,0)"):(a(b).css({"z-index":0}),a(b[k+1]).css({"z-index":2}).show(),b[k].style.webkitTransform="translate3d("+s/10+"px,0,0) scale("+(1-Math.abs(s/(h/20))/100)+")",b[k+1].style.webkitTransform="translate3d("+(h+s)+"px,0,0)"):c>=l?(a(b).css({"z-index":0}),a(b[k-1]).css({"z-index":2}).show(),b[k].style.webkitTransform="translate3d(0,"+s/10+"px,0) scale("+(1-Math.abs(s/(p/20))/100)+")",b[k-1].style.webkitTransform="translate3d(0,"+(s-p)+"px ,0)"):(a(b).css({"z-index":0}),a(b[k+1]).css({"z-index":2}).show(),b[k].style.webkitTransform="translate3d(0,"+s/10+"px,0) scale("+(1-Math.abs(s/(p/20))/100)+")",b[k+1].style.webkitTransform="translate3d(0,"+(p+s)+"px ,0)"))}}function n(s,e){if(k=s,"default"==v.swipeAnim){var r=0;"horizontal"==v.direction?(r=s*-h,u.css({"-webkit-transform":"matrix(1, 0, 0, 1, "+r+", 0)"})):(r=s*-p,u.css({"-webkit-transform":"matrix(1, 0, 0, 1, 0, "+r+")"}))}else"cover"==v.swipeAnim?v.drag?"forward"==e?(a(b[k-1]).addClass("back"),b[k].style.webkitTransform="translate3d(0, 0, 0)"):(a(b[k+1]).addClass("back"),b[k].style.webkitTransform="translate3d(0, 0, 0)"):"forward"==e?(u.addClass("animate"),a(b[k-1]).addClass("back"),a(b[k]).addClass("front").show(),console.log(1)):(u.addClass("animate"),a(b[k+1]).addClass("back"),a(b[k]).addClass("front").show(),console.log(2)):"victoria"==v.swipeAnim&&(v.drag?"forward"==e?(a(b[k-1]).addClass("back"),b[k-1].style.webkitTransform="horizontal"==v.direction?"translate3d(-60px, 0, 0) scale(0.8)":"translate3d(0, -60px, 0) scale(0.8)",b[k].style.webkitTransform="translate3d(0, 0, 0)"):(a(b[k+1]).addClass("back"),b[k+1].style.webkitTransform="horizontal"==v.direction?"translate3d(60px, 0, 0) scale(0.8)":"translate3d(0, 60px, 0) scale(0.8)",b[k].style.webkitTransform="translate3d(0, 0, 0)"):"forward"==e?(u.addClass("animate"),a(b[k-1]).addClass("back"),a(b[k]).addClass("front").show()):(u.addClass("animate"),a(b[k+1]).addClass("back"),a(b[k]).addClass("front").show()));g=!0,setTimeout(function(){g=!1},v.speed)}function o(){"horizontal"==v.direction?c>=l?u.removeClass("forward").addClass("backward"):l>c&&u.removeClass("backward").addClass("forward"):c>=l?u.removeClass("forward").addClass("backward"):l>c&&u.removeClass("backward").addClass("forward")}function d(){if("horizontal"==v.direction){if(c>=l&&0==k||l>=c&&k==m-1)return!0}else if(c>=l&&0==k||l>=c&&k==m-1)return!0;return!1}var l,c,w,f,m,h,p,u,b,v,k=0,x=!1,g=!0;a.fn.parallax=function(e){return v=a.extend({},a.fn.parallax.defaults,e),this.each(function(){u=a(this),b=u.find("section"),s()})},a.fn.parallax.defaults={direction:"portrait",swipeAnim:"default",drag:!1,loading:!1,indicator:!1,arrow:!1,music:!1,musicUrl:""},a(document).on("touchstart",function(a){e(a.changedTouches[0])}).on("touchmove",function(a){r(a.changedTouches[0])}).on("touchend",function(a){t(a.changedTouches[0])}).on("touchend",".h-music",function(){var s=a(this);s.hasClass("close")?s.removeClass("close"):s.addClass("close")}).on("orientationchange",function(){"default"==v.swipeAnim&&s()}).on("webkitAnimationEnd webkitTransitionEnd",function(){setTimeout(function(){a(".back").hide().removeClass("back"),a(".front").show().removeClass("front"),u.removeClass("animate")},10)}),a(window).on("load",function(){if(v.loading&&(setTimeout(function(){a(".h-loading").remove()},2e3),g=!1,a(b[k]).addClass("current")),v.indicator){g=!1,a(".helper").append('<div class="h-indicator"></div>');for(var s="<ul>",e=1;m>=e;e++)s+=1==e?'<li class="current">'+e+"</li>":"<li>"+e+"</li>";s+="</ul>",a(".h-indicator").append(s)}if(v.arrow&&(b.append('<span class="h-arrow"></span>'),a(b[m-1]).find(".h-arrow").remove()),v.music){if(g=!1,""==v.musicUrl)throw new Error("music url is needed.");a(".helper").append('<div class="h-music"><span class="h-music-inner"></span></div>')}})}(Zepto);